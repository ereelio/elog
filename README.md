## elog

**elog** 是一个C语言辅助日志格式化打印的简单工具。

### 日志级别

**elog** 将日志级别分为了七级，使用者可以根据自己的情况调用相应级别的宏函数打印日志，按照这种标准输出的日志，能让使用者跟踪或处理日志时更得心应手。也可以根据这个日志格式，开发相应的辅助工具辅助日志的分析。

|  级别  |   描述   | 使用场景                                                     |
| :----: | :------: | ------------------------------------------------------------ |
| panic  | 系统恐慌 | 使用于系统程序出现异常，程序不能继续正常执行的情况           |
| error  | 错误日志 | 系统某些模块调用或执行失败，但程序还能在勉强正常运行         |
|  warn  | 警告日志 | 系统或程序执行发生某些处于危险边缘的情况                     |
| notice | 提示日志 | 正常的日志，该日志输出用户比较关心的程序运行情况             |
|  info  | 信息日志 | 系统或程序正常运行产生的日志，记录用于后续追踪程序的执行情况 |
| debug  | 调试日志 | 程序或系统处于开发或调试时期，用于输出程序相关而和业务无关的日志 |
| trace  | 跟踪日志 | 用于在系统开发测试中，追踪某个模块程序的执行流程             |

根据程序目前的情况，可以调整日志打印的级别，低于所设置的级别的日志相关代码将不会编译到程序中。默认日志输出为 `info` 及其以上级别的日志，修改日志级别的方式则是通过代码`#define ELOG_OUTPUT_LEVEL ELOG_LEVEL_TRACE` 的方式，需要注意的是该宏定义需要放到`#include "elog.h"` 包含 头文件的代码之前。

### 日志标签

对于嵌入式裸机类的系统，一般日志都是通过串口直接输出，当系统稍微复杂一点，相信筛选串口助手打印出来的一堆日志让你感到抓狂，所以 **elog** 使用了一种在普通日志中注入标签的方式，它没有为日志打印函数添加参数，只是通过一种巧妙的宏展开方式将标签嵌入到你的常规日志中，这同你使用 `printf` 打印日志的方式几乎一样。使用示例如下：

```c
// main.c 123 line
elog_notice( E_TAG(test) "Hello %s!", "world" );
// main.c	124	NOTICE	<test>Hello world!
```

这样，上位机通过匹配 `<` `>` 便可以识别出标签的内容，这样就能通过上位机程序快速的筛选出你需要的数据。

### 键值载荷

对于一些传感器会不断产出数据且数据影响到程序执行的场景，我们往往或在日志中输出传感器采集到的数据，以便观察系统的运行趋势，但是快速输出的日志同样让你抓狂，所以 **elog** 使用了同日志标签一样的方式，通过键值对的形式在日志中注入期望观察的数据，这样通过上位机集成数据可视化组件，那你监看传感器或其他网络数据的采集情况将是轻松而优雅的。示例如下：

```c
// main.c 123 line
elog_info( "Hello %s!" E_KV(key, %d), "world", 100);
elog_info( "Hello %s!" E_KV(love, "%s"), "world", "I love elog!");
// main.c	124	INFO	Hello world![key:100]
// main.c	125	INFO	Hello world![love:"I love elog"]
```

### 推荐使用示例

通过上述的方式，你可以在日志中注入多个标签或键值载荷，虽然他们的顺序没什么要求，出现 `%` 开头的地方你同样的从左往右依次传参赋值即可，但是为了让没有较好上位机软件的人有更好的观感，你可以使用尽量少的标签和键值载荷，同时标签放置在头部，键值载荷放尾部，虽然这样的方式上位机处理日志时效率可能较低，但是现在的电脑性能应付起来也应该绰绰有余。示例如下：

```c
// main.c 123 line
elog_info( E_TAG(test) "Hello %s!" E_KV(love, "%s"), "world", "I love elog!");
// main.c	124 INFO	<test>Hello world![love:"I love elog"]
```

### 应用扩展

一般日志中，通常会包含产出日志的日期时间，但是对于嵌入式裸机类的程序，日志经常通过串口直接输出，因此，由上位机获取时间也是可取的方案，如果你有输出日期时间的需求，那么，修改该程序就像看上去一样简单。

### Licence

无 `licence` ,喜欢它，那它就是你的！